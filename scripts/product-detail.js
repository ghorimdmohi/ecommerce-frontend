const image=document.getElementById('main-image');const zoomLens=document.getElementById('zoom-lens');const priceEl=document.getElementById('product-price');const totalPriceEl=document.getElementById('total-price');const qtyInput=document.getElementById('quantity');const addBtn=document.getElementById('add-to-cart-btn');const feedback=document.getElementById('cart-feedback');async function loadProduct(){const id=new URLSearchParams(window.location.search).get('id');if(!id)return;const res=await fetch(`https://fakestoreapi.com/products/${id}`);const product=await res.json();document.getElementById('product-title').textContent=product.title;document.getElementById('product-description').textContent=product.description;priceEl.textContent=product.price.toFixed(2);totalPriceEl.textContent=product.price.toFixed(2);image.src=product.image;image.dataset.price=product.price;image.dataset.id=product.id;image.dataset.title=product.title}
document.getElementById('increase-qty').onclick=()=>{qtyInput.value=Math.min(10,parseInt(qtyInput.value)+1);updateTotal()};document.getElementById('decrease-qty').onclick=()=>{qtyInput.value=Math.max(1,parseInt(qtyInput.value)-1);updateTotal()};qtyInput.addEventListener('input',updateTotal);function updateTotal(){const basePrice=parseFloat(image.dataset.price);const quantity=parseInt(qtyInput.value);const total=basePrice*quantity;totalPriceEl.textContent=total.toFixed(2)}
addBtn.addEventListener('click',()=>{const cart=JSON.parse(localStorage.getItem('cart'))||[];const item={id:parseInt(image.dataset.id),title:image.dataset.title,price:parseFloat(image.dataset.price),quantity:parseInt(qtyInput.value),size:document.getElementById('size-select').value};const existing=cart.find(p=>p.id===item.id&&p.size===item.size);if(existing){existing.quantity+=item.quantity}else{cart.push(item)}
localStorage.setItem('cart',JSON.stringify(cart));feedback.classList.remove('hidden');updateCartCount();setTimeout(()=>feedback.classList.add('hidden'),2000)});image.addEventListener('mousemove',(e)=>{zoomLens.style.display='block';const rect=image.getBoundingClientRect();const x=e.clientX-rect.left-50;const y=e.clientY-rect.top-50;zoomLens.style.left=`${x}px`;zoomLens.style.top=`${y}px`});image.addEventListener('mouseleave',()=>zoomLens.style.display='none');loadProduct()